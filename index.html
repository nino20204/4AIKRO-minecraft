<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STORE 4AIKRO - Ultimate Gaming Hub</title>
    <meta name="description" content="STORE 4AIKRO - The ultimate store for Minecraft mods, ranks, and exclusive items. Join the elite.">
    <meta name="keywords" content="STORE 4AIKRO, 4AIKRO, Minecraft Server, Mods, Roblox, Game Store, Elite Gaming">
    <meta property="og:title" content="STORE 4AIKRO">
    <meta property="og:description" content="Join the elite. Exclusive items await.">
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1P984G5247"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-1P984G5247');
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Tajawal:wght@500;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #00e676;
            --secondary-color: #4CAF50;
            --bg-dark: #050505;
            --bronze-color: #cd7f32;
            --glass: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.08);
            --online-color: #22c55e;
            --offline-color: #ef4444;
            --rarity-common: #cccccc;
            --rarity-rare: #5555ff;
            --neon-glow: 0 0 10px rgba(0, 230, 118, 0.5);
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Cairo', sans-serif;
            margin: 0; padding: 0;
            background-color: var(--bg-dark); color: white;
            overflow-x: hidden; min-height: 100vh;
        }

        /* Dynamic Background */
        .bg-animation {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #050505;
            z-index: -1;
            overflow: hidden;
        }
        .bg-animation::after {
            content: '';
            position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: radial-gradient(circle, rgba(0,230,118,0.03) 0%, transparent 60%);
            animation: rotateBG 30s linear infinite;
        }
        @keyframes rotateBG { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0a0a0a; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--primary-color); }

        /* Header */
        .global-user-bar {
            position: fixed; top: 0; left: 0; width: 100%;
            background: rgba(5, 5, 5, 0.85); backdrop-filter: blur(20px);
            padding: 12px 20px; display: flex; justify-content: space-between; align-items: center;
            z-index: 1000; border-bottom: 1px solid var(--glass-border);
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }
        
        .brand-logo { 
            font-family: 'Tajawal', sans-serif; font-size: 1.8em; font-weight: 900; 
            background: linear-gradient(to right, #fff, #00e676); 
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; 
            cursor: pointer; transition: 0.3s; letter-spacing: 1px;
            text-shadow: var(--neon-glow);
        }
        .brand-logo:hover { transform: scale(1.05); filter: brightness(1.2); }
        
        .auth-actions { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; align-items: center; }
        
        .user-btn {
            background: rgba(255, 255, 255, 0.05); color: white; border: 1px solid var(--glass-border);
            padding: 8px 20px; border-radius: 12px; cursor: pointer; font-family: 'Cairo', sans-serif;
            transition: 0.3s; font-size: 0.9em; display: flex; align-items: center; gap: 8px; 
            font-weight: 700; text-decoration: none; position: relative; overflow: hidden;
        }
        .user-btn::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: translateX(-100%); transition: 0.5s;
        }
        .user-btn:hover::before { transform: translateX(100%); }
        .user-btn:hover { border-color: var(--primary-color); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,230,118,0.2); }
        
        .user-btn.profile-btn { background: rgba(0, 230, 118, 0.1); border: 1px solid rgba(0, 230, 118, 0.3); color: #fff; }
        
        .user-btn.logout-btn { background: transparent; border-color: rgba(255, 50, 50, 0.3); color: #ff5555; }
        .user-btn.logout-btn:hover { background: rgba(255, 50, 50, 0.1); border-color: #ff5555; }

        .key-badge { background: var(--bronze-color); color: white; padding: 2px 8px; border-radius: 20px; font-size: 0.8em; margin-right: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.3); }

        /* Landing Page */
        #landing-page { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; text-align: center; padding: 100px 20px 50px 20px; }
        
        .landing-logo { 
            width: 150px; height: 150px; border-radius: 50%; object-fit: cover; 
            border: 3px solid rgba(0, 230, 118, 0.3); box-shadow: 0 0 50px rgba(0, 230, 118, 0.3); 
            margin-bottom: 25px; 
            animation: pulseLogo 4s infinite; 
        }
        @keyframes pulseLogo { 0% { box-shadow: 0 0 30px rgba(0, 230, 118, 0.2); } 50% { box-shadow: 0 0 60px rgba(0, 230, 118, 0.5); } 100% { box-shadow: 0 0 30px rgba(0, 230, 118, 0.2); } }

        .landing-title { font-family: 'Tajawal', sans-serif; font-size: 3.5em; margin-bottom: 10px; background: linear-gradient(135deg, #ffffff, #00e676); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-transform: uppercase; letter-spacing: 3px; }
        .landing-subtitle { font-size: 1.2em; color: #666; margin-bottom: 50px; letter-spacing: 1px; }
        .choices-container { display: flex; gap: 30px; flex-wrap: wrap; justify-content: center; width: 100%; max-width: 900px; }
        
        .choice-card {
            width: 100%; max-width: 360px; height: auto; min-height: 420px;
            background: linear-gradient(145deg, rgba(20,20,20,0.8), rgba(10,10,10,0.9)); backdrop-filter: blur(20px);
            border-radius: 30px; cursor: pointer; transition: 0.4s;
            border: 1px solid rgba(255, 255, 255, 0.05); position: relative; overflow: hidden;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 25px; box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        .choice-card::before { content: ''; position: absolute; top: 1px; left: 1px; right: 1px; bottom: 1px; border-radius: 30px; border: 1px solid transparent; background: linear-gradient(135deg, rgba(255,255,255,0.1), transparent) border-box; -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0); -webkit-mask-composite: destination-out; mask-composite: exclude; pointer-events: none; opacity: 0; transition: 0.4s; }
        .choice-card:hover { transform: translateY(-15px) scale(1.01); border-color: transparent; box-shadow: 0 0 40px rgba(0, 230, 118, 0.15); }
        .choice-card:hover::before { opacity: 1; }
        .choice-card img { width: 120px; height: 120px; margin-bottom: 20px; filter: drop-shadow(0 10px 20px rgba(0,0,0,0.5)); transition: transform 0.4s; }
        .choice-card:hover img { transform: scale(1.1); }
        .choice-card h2 { font-size: 2em; margin: 0; color: #fff; text-shadow: 0 2px 10px rgba(0,0,0,0.5); }
        .choice-card p { color: #777; margin-top: 10px; }

        /* Content Pages */
        #minecraft-page, #roblox-page { display: none; }
        .container { width: 95%; max-width: 1400px; margin: 90px auto 30px auto; background: rgba(15, 15, 15, 0.6); backdrop-filter: blur(20px); padding: 25px; border-radius: 25px; border: 1px solid var(--glass-border); position: relative; }
        
        /* === FLOATING BACK BUTTON === */
        .back-btn { 
            position: fixed; 
            bottom: 30px; 
            left: 30px; 
            z-index: 1500; 
            border: none; 
            outline: none; 
            background: rgba(0, 0, 0, 0.8); 
            backdrop-filter: blur(10px);
            color: #fff; 
            cursor: pointer; 
            padding: 15px 25px; 
            border-radius: 50px; 
            font-size: 1em; 
            font-family: 'Cairo', sans-serif;
            font-weight: bold;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            transition: 0.3s;
            display: none; /* Hidden by default */
        }
        .back-btn:hover { background: var(--primary-color); color: #000; transform: scale(1.1); }
        .back-btn:active { transform: scale(0.95); }
        /* Show back button only on content pages */
        #minecraft-page.active-page .back-btn, #roblox-page.active-page .back-btn { display: block; }


        /* Modals */
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.95); backdrop-filter: blur(15px); overflow-y: auto; }
        .modal-content { 
            background: linear-gradient(145deg, #1a1a1a, #080808); 
            margin: 6% auto; padding: 40px 30px; border-radius: 30px; width: 90%; max-width: 420px; 
            border: 1px solid #222; text-align: center; position: relative; 
            box-shadow: 0 30px 80px rgba(0,0,0,0.7); animation: modalPop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes modalPop { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .modal-content h2 { margin-top: 0; color: var(--primary-color); margin-bottom: 25px; font-size: 1.8em; font-weight: 900; }
        .modal-content input { 
            width: 100%; padding: 15px; margin: 10px 0; border-radius: 15px; 
            border: 2px solid #222; background: #000; color: white; 
            font-family: 'Cairo', sans-serif; text-align: center; font-size: 1em; box-sizing: border-box; 
            transition: 0.3s;
        }
        .modal-content input:focus { border-color: var(--primary-color); outline: none; background: #0a0a0a; box-shadow: 0 0 15px rgba(0, 230, 118, 0.1); }
        .close-btn { position: absolute; top: 20px; left: 20px; font-size: 30px; cursor: pointer; color: #333; transition: 0.3s; font-weight: 300; }
        .close-btn:hover { color: #fff; transform: rotate(90deg); }
        .modal-link { font-size: 0.9em; color: #555; cursor: pointer; margin-top: 20px; display: block; transition: 0.3s; }
        .modal-link:hover { color: var(--primary-color); }
        
        /* Header */
        header { display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 15px; padding: 50px 20px; border-bottom: 1px solid rgba(255,255,255,0.05); margin-bottom: 25px; text-align: center; }
        .animated-gif { width: 160px; border-radius: 15px; box-shadow: 0 0 40px rgba(76, 175, 50, 0.3); border: 2px solid rgba(255,255,255,0.05); }
        .header-text { display: flex; flex-direction: column; align-items: center; gap: 10px; }
        header h1 { color: #fff; margin: 0; font-size: 2.5em; text-transform: uppercase; letter-spacing: 3px; text-shadow: 0 0 20px rgba(255,255,255,0.1); line-height: 1.2; font-family: 'Tajawal', sans-serif; }
        header p { margin: 0; color: #555; font-size: 0.9em; background: #111; padding: 5px 15px; border-radius: 50px; border: 1px solid #222; letter-spacing: 1px; }

        /* Cards */
        .balance-display { background: rgba(205, 127, 50, 0.1); padding: 6px 12px; border-radius: 8px; margin-bottom: 8px; border: 1px solid rgba(205, 127, 50, 0.2); display: inline-flex; justify-content: center; align-items: center; gap: 8px; font-size: 0.9em; color: #ccc; }
        .balance-count { font-size: 1.2em; font-weight: 900; color: var(--bronze-color); }
        
        .section { margin-bottom: 40px; opacity: 0; transform: translateY(50px); transition: all 0.8s ease; }
        .section.visible { opacity: 1; transform: translateY(0); }
        
        .section h2 { border-bottom: 2px solid var(--primary-color); padding-bottom: 10px; color: #fff; font-size: 1.6em; display: inline-block; margin-bottom: 20px; letter-spacing: 1px; }
        .card-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; align-items: start; }
        .card { background: #111; padding: 25px; border-radius: 20px; text-align: center; border: 1px solid #222; transition: 0.3s; display: flex; flex-direction: column; justify-content: space-between; height: 100%; overflow: hidden; position: relative; }
        .card:hover { transform: translateY(-5px); border-color: #333; box-shadow: 0 15px 30px rgba(0,0,0,0.5); background: #151515; }
        .rank-image { width: 100%; height: 110px; object-fit: contain; margin-bottom: 15px; transition: transform 0.3s; filter: drop-shadow(0 5px 10px rgba(0,0,0,0.5)); }
        .card:hover .rank-image { transform: scale(1.05); }
        
        .btn { 
            display: inline-block; background: linear-gradient(135deg, #4CAF50, #2E7D32); color: white; 
            padding: 12px 30px; text-decoration: none; border-radius: 50px; transition: 0.3s; 
            border: none; cursor: pointer; font-size: 1em; font-family: 'Cairo', sans-serif; font-weight: 700; 
            margin-top: 5px; box-shadow: 0 5px 15px rgba(76, 175, 50, 0.2);
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(76, 175, 50, 0.4); }
        .btn-bronze { background: linear-gradient(135deg, #cd7f32, #8b4513); box-shadow: 0 5px 15px rgba(205, 127, 50, 0.2); }
        .btn-rules { background: #222; border: 1px solid #333; box-shadow: none; }
        
        .server-status { 
            padding: 30px; border-radius: 20px; text-align: center; margin-bottom: 30px;
            border: 1px solid #222; color: #fff;
            background-image: linear-gradient(to bottom, rgba(0,0,0,0.7), rgba(0,0,0,0.9)), url('https://wallpapercave.com/wp/wp9336459.jpg');
            background-size: cover; background-position: center; box-shadow: inset 0 0 50px rgba(0,0,0,0.8);
        }

        .ip-box { background: rgba(0, 230, 118, 0.1); padding: 10px 20px; border-radius: 50px; display: inline-block; cursor: pointer; transition: 0.3s; border: 1px solid rgba(0, 230, 118, 0.3); font-weight: bold; font-size: 0.9em; margin-top: 10px; color: #fff; }
        .ip-box:hover { background: var(--primary-color); border-color: var(--primary-color); color: #000; }

        .status-text { font-size: 24px; font-weight: 900; transition: all 0.5s ease; letter-spacing: 1px; }
        .status-online { color: var(--online-color); text-shadow: 0 0 20px rgba(34, 197, 94, 0.8); }
        .status-offline { color: var(--offline-color); text-shadow: 0 0 20px rgba(239, 68, 68, 0.8); }
        
        /* Inventory 2.0 */
        .inventory-modal-content { max-width: 1000px; background: #080808; border: 1px solid #222; text-align: right; padding: 0; display: flex; flex-direction: column; height: 90vh; border-radius: 25px; overflow: hidden; }
        
        .inv-header { 
            padding: 20px; background: linear-gradient(to left, #0a0a0a, #050505); 
            display: flex; justify-content: space-between; align-items: center; 
            border-bottom: 1px solid #111; 
        }
        .inv-header h2 { margin: 0; font-size: 1.4em; display: flex; align-items: center; gap: 10px; color: #fff; }
        
        .inv-body { display: flex; flex: 1; overflow: hidden; }
        
        .inv-grid { 
            flex: 2; padding: 20px; display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); gap: 15px; 
            overflow-y: auto; background: #050505; border-left: 1px solid #111; 
            align-content: start; 
        }
        
        .inv-slot { 
            aspect-ratio: 1; background: #0a0a0a; border: 1px solid #222; 
            border-radius: 12px; cursor: pointer; position: relative; transition: 0.2s; 
            display: flex; align-items: center; justify-content: center; padding: 5px; 
        }
        .inv-slot:hover { border-color: #444; transform: scale(1.05); z-index: 2; background: #111; }
        .inv-slot.selected { border-color: var(--primary-color); box-shadow: 0 0 20px rgba(0, 230, 118, 0.2); background: #111; }
        .inv-slot img { width: 100%; height: 100%; object-fit: contain; filter: drop-shadow(0 2px 5px rgba(0,0,0,0.8)); }
        .inv-slot .item-count { position: absolute; bottom: 4px; left: 4px; background: #000; font-size: 0.75em; padding: 2px 6px; border-radius: 6px; font-weight: bold; border: 1px solid #222; }
        
        /* Rarity Effects */
        .rarity-common { border-color: #333; }
        .rarity-rare { border-color: var(--rarity-rare); box-shadow: inset 0 0 15px rgba(85, 85, 255, 0.2); }
        .rarity-rare img { filter: drop-shadow(0 0 5px rgba(85, 85, 255, 0.5)); }
        
        .inv-details { 
            flex: 1; padding: 30px 25px; background: #080808; 
            display: flex; flex-direction: column; align-items: center; text-align: center; overflow-y: auto; 
            justify-content: space-between; gap: 20px;
        }
        .inv-details-content { width: 100%; }
        .inv-details img { width: 100px; height: 100px; object-fit: contain; margin-bottom: 15px; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.5)); }
        .inv-details h3 { margin: 0 0 5px 0; font-size: 1.3em; color: #fff; font-weight: 900; }
        .inv-details .rarity-text { font-size: 0.9em; font-weight: bold; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px; }
        .inv-details p { font-size: 0.95em; color: #888; line-height: 1.5; margin: 0; }
        .inv-empty-msg { color: #333; text-align: center; margin-top: 50%; font-size: 1em; }

        /* Referral Box Redesigned */
        .referral-box {
            margin-top: 0; padding: 20px; background: #0a0a0a;
            border-radius: 15px; border: 1px solid #222; width: 100%; box-sizing: border-box;
            border-top: 3px solid var(--primary-color);
        }
        .referral-title { font-size: 1em; color: #fff; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; font-weight: 900; }
        .referral-stats { 
            font-size: 0.9em; color: #888; margin-bottom: 15px; display: block; 
            background: #111; padding: 8px; border-radius: 8px; border: 1px solid #1a1a1a;
        }
        .referral-stats span { color: var(--primary-color); font-weight: 900; font-size: 1.1em; }
        .referral-link-display { display: flex; gap: 8px; justify-content: center; align-items: center; }
        .referral-link-input {
            flex: 1; background: #000; border: 1px solid #222; padding: 10px;
            border-radius: 8px; color: #ccc; font-size: 0.85em; text-align: center;
            pointer-events: none; font-family: monospace;
        }
        .referral-copy-btn {
            background: var(--secondary-color); border: none; padding: 10px 20px;
            border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.9em; color: #fff; transition: 0.2s;
        }
        .referral-copy-btn:hover { filter: brightness(1.1); transform: translateY(-1px); }
        .referral-info { font-size: 0.8em; color: #555; margin-top: 10px; }

        /* Toast System */
        #toast-container {
            position: fixed; bottom: 30px; right: 30px; z-index: 9999; display: flex; flex-direction: column; gap: 15px;
        }
        .toast {
            background: #111; color: white; padding: 16px 24px; border-radius: 12px; 
            border-right: 4px solid var(--primary-color); border-left: 4px solid transparent;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); animation: slideIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), fadeOut 0.5s ease 3.0s forwards;
            display: flex; align-items: center; gap: 12px; font-size: 1em; max-width: 350px; border: 1px solid #222;
        }
        .toast.error { border-color: #ef4444; }
        .toast.success { border-color: var(--primary-color); }
        .toast.info { border-color: #3b82f6; }
        @keyframes slideIn { from { transform: translateX(100%) scale(0.8); opacity: 0; } to { transform: translateX(0) scale(1); opacity: 1; } }
        @keyframes fadeOut { to { opacity: 0; transform: translateX(50px); } }

        /* Scroll to top button - Hide when back button is visible */
        #scrollTopBtn { display: none; position: fixed; bottom: 30px; left: 30px; z-index: 1500; border: none; outline: none; background: var(--primary-color); color: #000; cursor: pointer; padding: 15px; border-radius: 50%; font-size: 18px; box-shadow: 0 5px 15px rgba(0,230,118,0.3); transition: 0.3s; }
        #scrollTopBtn:hover { background: #fff; transform: scale(1.1); }

        @media (max-width: 600px) {
            .brand-logo { font-size: 1.4em; }
            .container { margin: 80px auto 15px auto; padding: 15px; border-radius: 20px; }
            header h1 { font-size: 1.8em; }
            .inv-body { flex-direction: column; }
            .inv-grid { flex: none; height: 180px; overflow-x: auto; display: flex; flex-wrap: nowrap; grid-template-columns: none; border-left: none; border-bottom: 1px solid #111; }
            .inv-slot { min-width: 85px; }
            #toast-container { left: 15px; right: 15px; bottom: 15px; }
            .toast { width: 100%; justify-content: center; max-width: 100%; }
            
            /* Mobile Back Button adjustments */
            .back-btn { bottom: 20px; left: 20px; padding: 12px 20px; font-size: 0.9em; }
        }
    </style>
</head>
<body>

<div class="bg-animation"></div>
<!-- Scroll to top - Hidden on pages with back button to avoid overlap -->
<button onclick="topFunction()" id="scrollTopBtn" title="Back to Top">‚¨Ü</button>
<div id="toast-container"></div>

<!-- Header -->
<div class="global-user-bar">
    <div class="brand-logo" onclick="goHome()">STORE 4AIKRO</div>
    <div id="auth-btn-container" class="auth-actions"></div>
</div>

<!-- Universal Back Button (Floating) -->
<button id="main-back-btn" class="back-btn" onclick="goHome()">‚¨Ö Back</button>

<!-- Landing -->
<div id="landing-page">
    <img src="newlogosite.gif" alt="Logo" class="landing-logo">
    <h1 class="landing-title">Choose Your Path</h1>
    <p class="landing-subtitle">Exclusive content for elite players.</p>
    <div class="choices-container">
        <div class="choice-card" onclick="showPage('roblox')">
            <img src="logoroblox.png" alt="Roblox">
            <h2>ROBLOX</h2>
            <p>Endless possibilities.</p>
        </div>
        <div class="choice-card" onclick="showPage('minecraft')">
            <img src="logominecraft.png" alt="Minecraft">
            <h2>MINECRAFT</h2>
            <p>Official Java Servers.</p>
        </div>
    </div>
</div>

<!-- Roblox -->
<div id="roblox-page">
    <div class="container">
        <header><h1>ROBLOX</h1><p>Coming Soon</p></header>
    </div>
</div>

<!-- Minecraft -->
<div id="minecraft-page">
    <div class="container">
        <header>
            <img src="standard_1.gif" alt="GIF" class="animated-gif">
            <div class="header-text">
                <h1>‚öîÔ∏è 4AIKRO_S4 ‚öîÔ∏è</h1>
                <p>UPDATE: 1</p>
            </div>
        </header>

        <div class="server-status">
            <div class="status-text" id="status-text">Checking...</div>
            <span class="status-dot" id="status-dot"></span>
            <div class="status-info">
                <div id="player-count"></div>
                <div id="server-version"></div>
            </div>
            <div class="ip-box" onclick="copyIP()"><strong>IP:</strong> <span id="server-ip">cities-declare.gl.joinmc.link</span> üìã</div>
        </div>

        <div style="display: flex; justify-content: center; flex-wrap: wrap; gap: 10px; margin-bottom: 20px;">
            <a href="https://discord.gg/gMrHAzvERJ" target="_blank" class="btn" style="background:#5865F2;">Discord</a>
            <a href="https://www.mediafire.com/file/eyavtrl589c7s5x/mods_serveur_4AIKRO_S4.rar/file" class="btn" target="_blank">Download Mods</a>
            <button class="btn btn-rules" onclick="openModal('rules-modal')">‚öñÔ∏è Rules</button>
        </div>

        <div class="section">
            <h2>üíé Ranks & Gifts</h2>
            <div class="card-grid">
                <div class="card">
                    <div>
                        <img src="gift.png" alt="Daily Gift" class="rank-image">
                        <h3>Daily Gift</h3>
                        <p>Free gift every 24h.</p>
                        <div class="balance-display" id="key-balance-box" style="display:none;">
                            <span>Balance:</span>
                            <span class="balance-count" id="key-balance-num">0</span>
                        </div>
                    </div>
                    <div>
                        <div id="key-display-area" style="display:none; margin-bottom:10px;">
                            <div class="countdown-timer">‚è≥ <span id="timer-display">00:00:00</span></div>
                        </div>
                        <button id="claim-key-btn" class="btn btn-bronze" onclick="claimBronzeKey()">üîë Claim Key</button>
                    </div>
                </div>

                <div class="card">
                    <div>
                        <img src="vip.jpg" alt="VIP" class="rank-image">
                        <h3>VIP Rank</h3>
                        <p>Extra perks.</p>
                    </div>
                    <div class="price">$2.00</div>
                    <a href="#" class="btn">Buy</a>
                </div>

                <div class="card">
                    <div>
                        <img src="mvp.jpg" alt="MVP" class="rank-image">
                        <h3>MVP Rank</h3>
                        <p>Full permissions.</p>
                    </div>
                    <div class="price">$5.00</div>
                    <a href="#" class="btn">Buy</a>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>üõí Item Shop</h2>
            <div class="card-grid">
                <div class="card">
                    <img src="100coin.jpg" class="rank-image">
                    <h3>100 COIN</h3>
                    <div class="price">$1.00</div>
                    <a href="#" class="btn">Buy</a>
                </div>
                 <div class="card">
                    <img src="500coin.jpg" class="rank-image">
                    <h3>500 COIN</h3>
                    <div class="price">$3.00</div>
                    <a href="#" class="btn">Buy</a>
                </div>
                 <div class="card">
                    <img src="1000coin.jpg" class="rank-image">
                    <h3>1000 COIN</h3>
                    <div class="price">$5.00</div>
                    <a href="#" class="btn">Buy</a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modals -->
<div id="login-modal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal('login-modal')">&times;</span>
        <h2>Login</h2>
        <input type="text" id="login-name" placeholder="Username">
        <input type="password" id="login-code" placeholder="Secret Code">
        <button class="btn" onclick="handleLogin()" style="width:100%;">Enter</button>
        <span class="modal-link" onclick="openForgotModal()">Forgot Code?</span>
    </div>
</div>

<div id="forgot-modal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal('forgot-modal')">&times;</span>
        <h2>Recovery</h2>
        <p style="font-size:0.9em; color:#666; margin-bottom:15px;">Enter your email to find your code.</p>
        <input type="email" id="forgot-email" placeholder="Email">
        <button class="btn" onclick="handleForgot()" style="width:100%;">Search</button>
        <span class="modal-link" onclick="closeModal('forgot-modal'); openModal('login-modal');">Back to Login</span>
    </div>
</div>

<div id="register-modal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal('register-modal')">&times;</span>
        <div style="font-size:3em; margin-bottom:10px;">üìù</div>
        <h2>Create Account</h2>
        <input type="text" id="reg-name" placeholder="Username">
        <input type="password" id="reg-code" placeholder="Secret Code">
        <input type="email" id="reg-email" placeholder="Email (Required for recovery)">
        <button class="btn" onclick="handleRegister()" style="width:100%;">Create</button>
    </div>
</div>

<!-- Inventory -->
<div id="inventory-modal" class="modal">
    <div class="modal-content inventory-modal-content">
        <div class="inv-header">
            <h2>üì¶ Inventory</h2>
            <div style="display:flex; gap:10px; align-items:center;">
                <button class="user-btn logout-btn" onclick="logout()">üö™ Exit</button>
                <span class="close-btn" style="font-size:24px;" onclick="closeModal('inventory-modal')">&times;</span>
            </div>
        </div>
        <div class="inv-body">
            <div class="inv-grid" id="inv-grid"></div>
            <div class="inv-details" id="inv-details">
                <p class="inv-empty-msg">Select an item</p>
            </div>
        </div>
    </div>
</div>

<div id="rules-modal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal('rules-modal')">&times;</span>
        <h2>‚öñÔ∏è Server Rules</h2>
        <div style="text-align:right; line-height:1.8;">
            <p>üö´ <strong>No Hacking:</strong> External programs are banned.</p>
            <p>üó£Ô∏è <strong>Respect:</strong> No insults or harassment.</p>
            <p>üèóÔ∏è <strong>Building:</strong> Griefing is prohibited.</p>
            <p>üì¢ <strong>Chat:</strong> No advertising.</p>
        </div>
    </div>
</div>

<script>
    const GAME_ITEMS = {
        bronze_key: {
            id: 'bronze_key', name: 'COPPER KEY', description: 'A basic daily copper key.',
            image: 'COPPERKEY.png', rarity: 'common', max_stack: 25000
        }
    };
    const MAX_DAILY_REFERRALS = 5;
    let isProcessingReferral = false; 

    document.body.onload = function() { initApp(); };

    function initApp() { updateAuthUI(); checkReferralSystem(); }

    // === Referral Logic ===
    function checkReferralSystem() {
        const urlParams = new URLSearchParams(window.location.search);
        const referrer = urlParams.get('ref');

        if (referrer && !isProcessingReferral) {
            isProcessingReferral = true;
            
            const visitorId = getVisitorID();
            const hasVisited = localStorage.getItem('visitor_counted');

            if (hasVisited) return; 

            const currentLoggedIn = getCurrentUser();
            if (referrer === currentLoggedIn) return;

            let db = getDB();
            if (!db[referrer]) return;

            const today = new Date().toISOString().split('T')[0];
            if (!db[referrer].referrals || db[referrer].referrals.date !== today) {
                db[referrer].referrals = { date: today, count: 0 };
            }

            if (db[referrer].referrals.count >= MAX_DAILY_REFERRALS) return;

            if (!db[referrer].inventory) db[referrer].inventory = [];
            let itemEntry = db[referrer].inventory.find(i => i.id === 'bronze_key');
            if (itemEntry) itemEntry.count++;
            else db[referrer].inventory.push({ id: 'bronze_key', count: 1 });

            db[referrer].referrals.count++;
            localStorage.setItem('visitor_counted', 'true');
            saveDB(db);

            if (getCurrentUser() === referrer) {
                showToast("üéâ Reward! A new player joined via your link!", 'success');
                updateAuthUI();
                renderInventoryGrid();
            }
        }
    }

    function getVisitorID() {
        let id = localStorage.getItem('visitor_uuid');
        if (!id) {
            id = 'vid_' + Math.random().toString(36).substr(2, 9) + Date.now();
            localStorage.setItem('visitor_uuid', id);
        }
        return id;
    }

    // === Database ===
    function getDB() { try { return JSON.parse(localStorage.getItem('4aikro_db')) || {}; } catch (e) { return {}; } }
    function saveDB(db) { localStorage.setItem('4aikro_db', JSON.stringify(db)); }
    function getCurrentUser() { return localStorage.getItem('4aikro_session'); }
    function setCurrentUser(username) { localStorage.setItem('4aikro_session', username); }

    function showToast(message, type = 'success') {
        const container = document.getElementById('toast-container');
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        toast.innerHTML = message;
        container.appendChild(toast);
        setTimeout(() => toast.remove(), 3500);
    }

    // === Auth UI ===
    function updateAuthUI() {
        const container = document.getElementById('auth-btn-container');
        const username = getCurrentUser();
        const isLandingVisible = document.getElementById('landing-page').style.display !== 'none';
        
        if (username) {
            const db = getDB();
            const userObj = db[username] || {};
            const oldKeys = userObj.mc_keys ? userObj.mc_keys.length : 0;
            const newItems = userObj.inventory ? userObj.inventory.reduce((sum, item) => sum + item.count, 0) : 0;
            const totalCount = oldKeys + newItems;

            container.innerHTML = `
                <div class="user-btn profile-btn" onclick="openInventoryModal()">
                    üë§ ${username}
                    <span class="key-badge">üéí ${totalCount}</span>
                </div>
                <button class="user-btn logout-btn" onclick="logout()">üö™ Exit</button>
            `;

            const balanceNum = document.getElementById('key-balance-num');
            const balanceBox = document.getElementById('key-balance-box');
            if(balanceNum) balanceNum.innerText = totalCount;
            if(balanceBox) balanceBox.style.display = 'inline-flex';
            updateReferralUI(username);

        } else {
            if (isLandingVisible) {
                container.innerHTML = `<button class="user-btn" onclick="openModal('login-modal')">üîë Login</button><button class="user-btn" onclick="openModal('register-modal')" style="border-color:#cd7f32;">üìù Register</button>`;
            } else { container.innerHTML = ''; }
            const balanceBox = document.getElementById('key-balance-box');
            if(balanceBox) balanceBox.style.display = 'none';
        }
    }
    
    function updateReferralUI(username) {
        const refLinkInput = document.getElementById('ref-link-display');
        const refStats = document.getElementById('ref-stats-display');
        
        if(refLinkInput) {
            const path = window.location.origin + window.location.pathname;
            refLinkInput.value = `${path}?ref=${encodeURIComponent(username)}`;
        }
        
        const db = getDB();
        const today = new Date().toISOString().split('T')[0];
        let count = 0;
        if (db[username] && db[username].referrals && db[username].referrals.date === today) {
            count = db[username].referrals.count;
        }
        if(refStats) refStats.innerHTML = `Today's Invites: <span>${count}/${MAX_DAILY_REFERRALS}</span>`;
    }

    function openModal(id) { document.getElementById(id).style.display = 'block'; }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    function openForgotModal() { closeModal('login-modal'); openModal('forgot-modal'); }

    function handleForgot() {
        const email = document.getElementById('forgot-email').value.trim();
        if(!email) { showToast("Enter email", "error"); return; }
        let db = getDB();
        let foundUser = null;
        for(let user in db) { if(db[user].email === email) { foundUser = user; break; } }
        if(foundUser) {
            showToast(`‚úÖ Found! Code: <b style='color:var(--primary-color)'>${db[foundUser].code}</b>`, 'success');
            closeModal('forgot-modal');
        } else { showToast("‚ùå Email not found.", "error"); }
    }

    function handleLogin() {
        const name = document.getElementById('login-name').value.trim();
        const code = document.getElementById('login-code').value.trim();
        if (!name || !code) { showToast("Enter name and code", "error"); return; }
        let db = getDB();
        if (db[name] && db[name].code === code) {
            setCurrentUser(name); closeModal('login-modal'); updateAuthUI(); initKeyLogic();
            showToast(`Welcome, ${name} üëã`, 'success');
        } else { showToast("Wrong name or code", "error"); }
    }

    function handleRegister() {
        const name = document.getElementById('reg-name').value.trim();
        const code = document.getElementById('reg-code').value.trim();
        const email = document.getElementById('reg-email').value.trim();
        if (!name || !code || !email) { showToast("All fields required", "error"); return; }
        let db = getDB();
        if (db[name]) { showToast("Name exists!", "error"); return; }
        db[name] = { code: code, email: email, inventory: [], referrals: { date: '', count: 0 } };
        saveDB(db);
        setCurrentUser(name); closeModal('register-modal'); updateAuthUI(); initKeyLogic();
        showToast("Account created! üéâ");
    }

    function logout() { localStorage.removeItem('4aikro_session'); updateAuthUI(); initKeyLogic(); closeModal('inventory-modal'); showToast("Logged out"); }

    // === Inventory ===
    function openInventoryModal() {
        const username = getCurrentUser();
        if (!username) return;
        let db = getDB();
        if (!db[username]) db[username] = {};
        if (!db[username].inventory) db[username].inventory = [];
        if (db[username].mc_keys && db[username].mc_keys.length > 0) {
            db[username].mc_keys.forEach(() => addItemToInventory('bronze_key', false, false));
            delete db[username].mc_keys; saveDB(db); updateAuthUI();
        }
        renderInventoryGrid(); updateReferralUI(username); openModal('inventory-modal');
    }

    function addItemToInventory(itemId, alertUser = true, checkMaxStack = true) {
        const username = getCurrentUser();
        let db = getDB();
        if (!db[username]) db[username] = {};
        if (!db[username].inventory) db[username].inventory = [];
        let itemEntry = db[username].inventory.find(i => i.id === itemId);
        const itemData = GAME_ITEMS[itemId];
        const maxStack = itemData ? itemData.max_stack : 64;
        if (itemEntry) {
            if (checkMaxStack && itemEntry.count >= maxStack) {
                if(alertUser) showToast(`‚ö†Ô∏è Max stack (${maxStack}) reached!`, 'error'); return;
            }
            itemEntry.count++;
        } else { db[username].inventory.push({ id: itemId, count: 1 }); }
        saveDB(db); updateAuthUI();
        if(alertUser) showToast("üéâ Item added!");
    }

    function renderInventoryGrid() {
        const username = getCurrentUser();
        const db = getDB();
        let inventory = db[username]?.inventory || [];
        // Sort: Rare first
        inventory.sort((a, b) => {
            const itemA = GAME_ITEMS[a.id]; const itemB = GAME_ITEMS[b.id];
            if(itemA.rarity !== itemB.rarity) return itemA.rarity === 'rare' ? -1 : 1;
            return b.count - a.count;
        });

        const grid = document.getElementById('inv-grid');
        const details = document.getElementById('inv-details');
        
        // Referral Box in Details Panel
        details.innerHTML = `
            <div class="inv-details-content">
                 <div style="flex-grow:1; display:flex; align-items:center; justify-content:center;">
                    <p class="inv-empty-msg">Select an item</p>
                </div>
            </div>
            <div class="referral-box">
                <span class="referral-title">üîó Invite Friends</span>
                <span class="referral-stats" id="ref-stats-display">...</span>
                <div class="referral-link-display">
                    <input type="text" id="ref-link-display" class="referral-link-input" readonly>
                    <button class="referral-copy-btn" onclick="copyRefLink()">Copy</button>
                </div>
                <p class="referral-info">Get a free key for every new friend! (Max 5/day)</p>
            </div>
        `;
        updateReferralUI(username);

        if (inventory.length === 0) {
            grid.innerHTML = '<p style="grid-column: 1/-1; text-align:center; color:#333; padding:20px;">Empty</p>';
            return;
        }

        grid.innerHTML = inventory.map((entry, index) => {
            const itemData = GAME_ITEMS[entry.id];
            if(!itemData) return '';
            return `
            <div class="inv-slot rarity-${itemData.rarity}" onclick="showItemDetails(${index})">
                <img src="${itemData.image}" alt="${itemData.name}">
                ${entry.count > 1 ? `<span class="item-count">x${entry.count}</span>` : ''}
            </div>`;
        }).join('');
    }

    function showItemDetails(index) {
        const username = getCurrentUser();
        const db = getDB();
        let inventory = db[username].inventory || [];
        // Apply same sort
        inventory.sort((a, b) => {
            const itemA = GAME_ITEMS[a.id]; const itemB = GAME_ITEMS[b.id];
            if(itemA.rarity !== itemB.rarity) return itemA.rarity === 'rare' ? -1 : 1;
            return b.count - a.count;
        });

        const entry = inventory[index];
        const itemData = GAME_ITEMS[entry.id];
        
        document.querySelectorAll('.inv-slot').forEach(el => el.classList.remove('selected'));
        document.querySelectorAll('.inv-slot')[index].classList.add('selected');

        const details = document.getElementById('inv-details');
        let color = '#fff'; let name = 'COMMON';
        if(itemData.rarity === 'rare') { color = 'var(--rarity-rare)'; name = 'RARE'; }

        details.innerHTML = `
            <div class="inv-details-content">
                <img src="${itemData.image}" style="filter: drop-shadow(0 5px 20px ${color});">
                <h3 style="color:${color};">${itemData.name}</h3>
                <div class="rarity-text" style="color:${color};">${name}</div>
                <p>${itemData.description}</p>
                <div style="margin-top:15px; font-size:0.9em; color:#555;">Amount: ${entry.count} / ${itemData.max_stack}</div>
            </div>
            <div class="referral-box">
                <span class="referral-title">üîó Invite Link</span>
                <span class="referral-stats" id="ref-stats-display"></span>
                <div class="referral-link-display">
                    <input type="text" id="ref-link-display" class="referral-link-input" readonly>
                    <button class="referral-copy-btn" onclick="copyRefLink()">Copy</button>
                </div>
                <p class="referral-info">Share to earn free keys!</p>
            </div>
        `;
        updateReferralUI(username);
    }
    
    function copyRefLink() {
        const input = document.getElementById('ref-link-display');
        if(input && input.value) {
            navigator.clipboard.writeText(input.value);
            showToast("‚úîÔ∏è Link Copied!", 'success');
        }
    }

    function openRulesModal() { openModal('rules-modal'); }

    function showPage(pageName) {
        document.getElementById('landing-page').style.display = 'none';
        document.getElementById('minecraft-page').style.display = 'none';
        document.getElementById('roblox-page').style.display = 'none';

        // Manage Back Button Visibility
        const backBtn = document.getElementById('main-back-btn');
        backBtn.style.display = 'block';
        document.getElementById(pageName + '-page').classList.add('active-page');

        if (pageName === 'minecraft') {
            document.getElementById('minecraft-page').style.display = 'block';
            checkServerStatus(); initKeyLogic(); updateAuthUI(); setTimeout(revealOnScroll, 100); 
        } else if (pageName === 'roblox') { 
            document.getElementById('roblox-page').style.display = 'block'; updateAuthUI(); 
        }
    }
    
    function goHome() { 
        document.getElementById('landing-page').style.display = 'flex';
        document.getElementById('minecraft-page').style.display = 'none';
        document.getElementById('roblox-page').style.display = 'none';
        
        // Hide Back Button
        const backBtn = document.getElementById('main-back-btn');
        backBtn.style.display = 'none';
        document.querySelectorAll('.active-page').forEach(e => e.classList.remove('active-page'));
        
        updateAuthUI();
    }

    const COOLDOWN_TIME = 24 * 60 * 60 * 1000; 
    let timerInterval;

    function initKeyLogic() {
        const claimBtn = document.getElementById('claim-key-btn');
        const displayArea = document.getElementById('key-display-area');
        if(!claimBtn) return;
        const username = getCurrentUser();
        if (!username) { claimBtn.disabled = false; claimBtn.innerText = "üîë Login"; claimBtn.onclick = () => openModal('login-modal'); displayArea.style.display = 'none'; return; }
        const lastClaim = localStorage.getItem(`mc_keyTime_${username}`);
        if (lastClaim) {
            const nextClaimTime = parseInt(lastClaim) + COOLDOWN_TIME;
            const now = new Date().getTime();
            if (now < nextClaimTime) { claimBtn.disabled = true; claimBtn.innerText = "‚è≥ Wait"; displayArea.style.display = 'block'; startCountdown(nextClaimTime); } else { setupClaimable(); }
        } else { setupClaimable(); }
    }

    function setupClaimable() { const claimBtn = document.getElementById('claim-key-btn'); if(!claimBtn) return; claimBtn.disabled = false; claimBtn.innerText = "üîë Claim Key"; claimBtn.onclick = claimBronzeKey; document.getElementById('key-display-area').style.display = 'none'; }
    function claimBronzeKey() { const username = getCurrentUser(); if(!username) return; addItemToInventory('bronze_key'); localStorage.setItem(`mc_keyTime_${username}`, new Date().getTime()); initKeyLogic(); }
    function startCountdown(endTime) { clearInterval(timerInterval); const timerDisplay = document.getElementById('timer-display'); function updateTimer() { const now = new Date().getTime(); const distance = endTime - now; if (distance < 0) { clearInterval(timerInterval); setupClaimable(); } else { const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)); const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60)); const seconds = Math.floor((distance % (1000 * 60)) / 1000); if(timerDisplay) timerDisplay.innerHTML = `${hours}h ${minutes}m ${seconds}s`; } } updateTimer(); timerInterval = setInterval(updateTimer, 1000); }

    function copyIP() { navigator.clipboard.writeText(document.getElementById("server-ip").innerText); showToast("IP Copied!", 'success'); }
    function checkServerStatus() {
        const statusText = document.getElementById("status-text"); const statusDot = document.getElementById("status-dot"); const playerElement = document.getElementById("player-count"); const versionElement = document.getElementById("server-version");
        statusText.innerText = "Checking..."; statusText.classList.remove("status-online", "status-offline"); statusDot.classList.remove("dot-online", "dot-offline"); playerElement.innerText = ""; versionElement.innerText = "";
        fetch("https://api.mcstatus.io/v2/status/java/cities-declare.gl.joinmc.link")
            .then(response => response.json())
            .then(data => {
                if (data && data.online === true) { statusText.innerText = "üü¢ Online"; statusText.classList.add("status-online"); statusDot.classList.add("dot-online"); playerElement.innerText = "Players: " + data.players.online + " / " + data.players.max; versionElement.innerText = "Version: " + data.version.name_clean; }
                else { statusText.innerText = "üî¥ Offline"; statusText.classList.add("status-offline"); statusDot.classList.add("dot-offline"); }
            })
            .catch(error => { statusText.innerText = "‚ö†Ô∏è Error"; statusText.classList.add("status-offline"); statusDot.classList.add("dot-offline"); });
    }

    function revealOnScroll() { const reveals = document.querySelectorAll(".section"); reveals.forEach(element => { const windowHeight = window.innerHeight; const elementTop = element.getBoundingClientRect().top; if (elementTop < windowHeight - 150) { element.classList.add("visible"); } }); }
    window.addEventListener("scroll", revealOnScroll);
    
    function scrollFunction() {
      const backBtn = document.getElementById('main-back-btn');
      // If back button is visible (we are on a sub-page), hide scroll top button to avoid overlap
      if (backBtn.style.display === 'block') {
          document.getElementById("scrollTopBtn").style.display = 'none';
          return;
      }

      if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
        document.getElementById("scrollTopBtn").style.display = "block";
      } else {
        document.getElementById("scrollTopBtn").style.display = "none";
      }
    }
    window.onscroll = function() { scrollFunction(); };

    function topFunction() { document.body.scrollTop = 0; document.documentElement.scrollTop = 0; }
</script>
</body>
</html>
